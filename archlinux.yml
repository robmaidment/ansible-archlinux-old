- hosts: archy
  sudo: yes
  remote_user: vagrant
  tasks:
#    - name: update pacman
#      pacman: update_cache=yes
    - name: install git
      pacman: name={{ item }}
      with_items:
       - git
       - i3-wm
       - dunst
       - feh
       - slim
       - vim
    - name: test if yaourt installed
      command: /usr/bin/pacman -Qs yaourt
      register: yaourt_check
      ignore_errors: true
    - name: Add repository to install yaourt if not present
      lineinfile:
          dest=/etc/pacman.conf
          state=present
          line: "{{ item }}"
       with_items:
        - "[archlinuxfr]"
        - "SigLevel = Never"
        - "Server = http://repo.archlinux.fr/$arch"
      when: yaourt_check|failed
    - name: install yaourt if not present
      pacman: name=yaourt state=present update_cache=yes
      when: yaourt_check|failed
